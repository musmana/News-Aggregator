<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>News Aggregator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .news-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .news-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <header class="bg-white shadow-sm sticky top-0 z-10">
        <div class="container mx-auto px-4 py-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="flex items-center mb-4 md:mb-0">
                    <i class="fas fa-newspaper text-blue-600 text-2xl mr-3"></i>
                    <h1 class="text-2xl font-bold text-gray-800">Global News Hub</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <select id="categoryFilter" class="appearance-none bg-white border border-gray-300 rounded-lg py-2 pl-3 pr-10 text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="general">All Categories</option>
                            <option value="business">Business</option>
                            <option value="entertainment">Entertainment</option>
                            <option value="health">Health</option>
                            <option value="science">Science</option>
                            <option value="sports">Sports</option>
                            <option value="technology">Technology</option>
                            <option value="world">World</option>
                            <option value="nation">Nation</option>
                        </select>
                        <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                            <i class="fas fa-chevron-down"></i>
                        </div>
                    </div>
                    <button id="refreshBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition duration-200 flex items-center">
                        <i class="fas fa-sync-alt mr-2"></i>
                        Refresh
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8">
        <!-- Loading Spinner -->
        <div id="loadingSpinner" class="flex flex-col items-center justify-center py-12 hidden">
            <div class="animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-600 mb-4"></div>
            <p class="text-gray-600">Fetching the latest news...</p>
        </div>

        <!-- Error Message -->
        <div id="errorMessage" class="bg-red-50 border border-red-200 rounded-lg p-6 mb-8 hidden">
            <div class="flex items-center">
                <i class="fas fa-exclamation-triangle text-red-500 text-xl mr-3"></i>
                <h3 class="text-lg font-medium text-red-800" id="errorTitle">Error</h3>
            </div>
            <p class="mt-2 text-red-700" id="errorText">An error occurred while fetching news.</p>
        </div>

        <!-- News Grid -->
        <div id="newsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Demo news cards (shown initially) -->
            <div class="news-card bg-white rounded-xl shadow-md overflow-hidden">
                <div class="h-48 bg-gradient-to-r from-blue-400 to-blue-600 flex items-center justify-center">
                    <i class="fas fa-newspaper text-white text-4xl"></i>
                </div>
                <div class="p-5">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm font-medium text-blue-600 bg-blue-50 px-2 py-1 rounded">News Hub</span>
                        <span class="text-xs text-gray-500">Just now</span>
                    </div>
                    <h3 class="font-bold text-lg mb-3">Welcome to Global News Hub</h3>
                    <p class="text-gray-600 mb-4">Select a category and click refresh to load the latest news headlines from around the world.</p>
                    <div class="flex justify-between items-center">
                        <button class="text-blue-600 hover:text-blue-800 font-medium flex items-center">
                            Get Started
                            <i class="fas fa-arrow-right ml-1 text-sm"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div class="news-card bg-white rounded-xl shadow-md overflow-hidden">
                <div class="h-48 bg-gradient-to-r from-green-400 to-green-600 flex items-center justify-center">
                    <i class="fas fa-globe text-white text-4xl"></i>
                </div>
                <div class="p-5">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm font-medium text-green-600 bg-green-50 px-2 py-1 rounded">Global</span>
                        <span class="text-xs text-gray-500">Just now</span>
                    </div>
                    <h3 class="font-bold text-lg mb-3">Real-time News Updates</h3>
                    <p class="text-gray-600 mb-4">Stay informed with the latest breaking news from multiple categories including technology, sports, and business.</p>
                    <div class="flex justify-between items-center">
                        <button class="text-green-600 hover:text-green-800 font-medium flex items-center">
                            Explore News
                            <i class="fas fa-arrow-right ml-1 text-sm"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div class="news-card bg-white rounded-xl shadow-md overflow-hidden">
                <div class="h-48 bg-gradient-to-r from-purple-400 to-purple-600 flex items-center justify-center">
                    <i class="fas fa-mobile-alt text-white text-4xl"></i>
                </div>
                <div class="p-5">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm font-medium text-purple-600 bg-purple-50 px-2 py-1 rounded">Mobile</span>
                        <span class="text-xs text-gray-500">Just now</span>
                    </div>
                    <h3 class="font-bold text-lg mb-3">Responsive Design</h3>
                    <p class="text-gray-600 mb-4">Access your news on any device with our fully responsive design that works seamlessly on desktop, tablet, and mobile.</p>
                    <div class="flex justify-between items-center">
                        <button class="text-purple-600 hover:text-purple-800 font-medium flex items-center">
                            Read More
                            <i class="fas fa-arrow-right ml-1 text-sm"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- No Results Message -->
        <div id="noResults" class="text-center py-12 hidden">
            <i class="fas fa-newspaper text-gray-300 text-6xl mb-4"></i>
            <h3 class="text-xl font-medium text-gray-700 mb-2">No news found</h3>
            <p class="text-gray-500">Try selecting a different category or refreshing the page.</p>
        </div>
    </main>

    <footer class="bg-white border-t border-gray-200 mt-12">
        <div class="container mx-auto px-4 py-6">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <p class="text-gray-600 mb-4 md:mb-0">Powered by GNews API | Real-time News Aggregator</p>
                <div class="flex space-x-4">
                    <a href="#" class="text-gray-500 hover:text-blue-600 transition duration-200">
                        <i class="fab fa-github text-xl"></i>
                    </a>
                    <a href="#" class="text-gray-500 hover:text-blue-600 transition duration-200">
                        <i class="fab fa-twitter text-xl"></i>
                    </a>
                    <a href="#" class="text-gray-500 hover:text-blue-600 transition duration-200">
                        <i class="fab fa-linkedin text-xl"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // GNews API Configuration
        const API_KEY = '1e8e7e84a4e4c14e6c9c4a8e4c14e6c9'; // Free demo key (replace with your own)
        const BASE_URL = 'https://gnews.io/api/v4';
        
        // DOM Elements
        const newsContainer = document.getElementById('newsContainer');
        const categoryFilter = document.getElementById('categoryFilter');
        const refreshBtn = document.getElementById('refreshBtn');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const errorMessage = document.getElementById('errorMessage');
        const noResults = document.getElementById('noResults');
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Load last selected category from sessionStorage
            const savedCategory = sessionStorage.getItem('selectedCategory');
            if (savedCategory) {
                categoryFilter.value = savedCategory;
            }
            
            // Event listeners
            categoryFilter.addEventListener('change', function() {
                const category = this.value;
                sessionStorage.setItem('selectedCategory', category);
                fetchNewsByCategory(category);
            });
            
            refreshBtn.addEventListener('click', function() {
                const category = categoryFilter.value;
                fetchNewsByCategory(category);
            });
        });
        
        // Fetch top headlines using .then() chains
        function fetchTopHeadlines() {
            showLoading();
            hideError();
            hideNoResults();
            
            fetch(`${BASE_URL}/top-headlines?token=${API_KEY}&lang=en&max=9`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    hideLoading();
                    if (data.articles && data.articles.length > 0) {
                        displayNews(data.articles);
                    } else {
                        showNoResults();
                    }
                })
                .catch(error => {
                    hideLoading();
                    showError('Failed to fetch news', error.message);
                    console.error('Error:', error);
                });
        }
        
        // Fetch news by category using async/await
        async function fetchNewsByCategory(category) {
            showLoading();
            hideError();
            hideNoResults();
            
            try {
                let url;
                if (category === 'general') {
                    url = `${BASE_URL}/top-headlines?token=${API_KEY}&lang=en&max=9`;
                } else {
                    url = `${BASE_URL}/top-headlines?token=${API_KEY}&lang=en&topic=${category}&max=9`;
                }
                
                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }
                
                const data = await response.json();
                hideLoading();
                
                if (data.articles && data.articles.length > 0) {
                    displayNews(data.articles);
                } else {
                    showNoResults();
                }
            } catch (error) {
                hideLoading();
                showError('Failed to fetch news', error.message);
                console.error('Error:', error);
            }
        }
        
        // Display news articles
        function displayNews(articles) {
            newsContainer.innerHTML = '';
            
            articles.forEach((article, index) => {
                const newsCard = createNewsCard(article, index);
                newsContainer.appendChild(newsCard);
            });
        }
        
        // Create a news card element
        function createNewsCard(article, index) {
            const card = document.createElement('div');
            card.className = 'news-card bg-white rounded-xl shadow-md overflow-hidden fade-in';
            card.style.animationDelay = `${index * 0.1}s`;
            
            // Use placeholder image if none available
            const imageUrl = article.image || `https://picsum.photos/400/200?random=${index}`;
            const title = article.title || 'No title available';
            const description = article.description || 'No description available. Click "Read More" to view the full article.';
            const source = article.source?.name || 'Unknown source';
            const publishedAt = new Date(article.publishedAt).toLocaleDateString();
            
            card.innerHTML = `
                <div class="h-48 overflow-hidden">
                    <img src="${imageUrl}" alt="${title}" class="w-full h-full object-cover" onerror="this.src='https://picsum.photos/400/200?random=${index}'">
                </div>
                <div class="p-5">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm font-medium text-blue-600 bg-blue-50 px-2 py-1 rounded">${source}</span>
                        <span class="text-xs text-gray-500">${publishedAt}</span>
                    </div>
                    <h3 class="font-bold text-lg mb-3 line-clamp-2">${title}</h3>
                    <p class="text-gray-600 mb-4 line-clamp-3">${description}</p>
                    <div class="flex justify-between items-center">
                        <a href="${article.url}" target="_blank" class="text-blue-600 hover:text-blue-800 font-medium flex items-center">
                            Read More
                            <i class="fas fa-arrow-right ml-1 text-sm"></i>
                        </a>
                        <button class="text-gray-400 hover:text-blue-500">
                            <i class="far fa-bookmark"></i>
                        </button>
                    </div>
                </div>
            `;
            
            return card;
        }
        
        // UI Helper Functions
        function showLoading() {
            loadingSpinner.classList.remove('hidden');
            newsContainer.classList.add('hidden');
        }
        
        function hideLoading() {
            loadingSpinner.classList.add('hidden');
            newsContainer.classList.remove('hidden');
        }
        
        function showError(title, message) {
            document.getElementById('errorTitle').textContent = title;
            document.getElementById('errorText').textContent = message;
            errorMessage.classList.remove('hidden');
        }
        
        function hideError() {
            errorMessage.classList.add('hidden');
        }
        
        function showNoResults() {
            noResults.classList.remove('hidden');
            newsContainer.classList.add('hidden');
        }
        
        function hideNoResults() {
            noResults.classList.add('hidden');
        }
    </script>
</body>
</html>